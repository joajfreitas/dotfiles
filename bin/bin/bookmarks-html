#!/usr/bin/env python3

import jinja2
import json
import subprocess, sys

HTML = sys.argv[1]
BOOKMARKS = sys.argv[2]
TEMPLATE = sys.argv[3]

p = subprocess.run(["bookmarks", "print", "0", BOOKMARKS], stdout=subprocess.PIPE)
with open(TEMPLATE) as file:
    template = jinja2.Template(file.read())

#titles = []
#urls = p.stdout.decode('utf-8').split('\n')
#for i, url in enumerate(urls):
#    print(i)
#    print(url)
#    titles.append(get_title(url))

lines = []
with open(HTML, "w") as html_page:
    for line in p.stdout.decode('utf-8').split('\n'):
        split = line.split()
        if len(split) < 2:
            continue
        number, url = split[0], split[1]
        print(number)
        print(url)
        lines.append((number, url))
        
    html_page.write(template.render(BOOKMARKS=lines))
#

